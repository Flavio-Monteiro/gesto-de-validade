<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestor de Validade</title>
    <link rel="stylesheet" href="main.css" />
</head>

<body>
    <div class="container">
        <!-- Documenta√ß√£o em uma tag <details> -->
        <details>
            <summary>
                Documenta√ß√£o: Como usar o Gestor de Validade em Estoque
            </summary>
            <div class="documentacao">
                <h2>1. Estrutura do Projeto</h2>
                <p>O projeto √© composto por tr√™s arquivos principais:</p>
                <ul>
                    <li>
                        <strong>index.html</strong>: Cont√©m a estrutura da p√°gina web.
                    </li>
                    <li>
                        <strong>main.css</strong>: Define o estilo visual da aplica√ß√£o.
                    </li>
                    <li>
                        <strong>main.js</strong>: Implementa a l√≥gica de funcionamento da
                        aplica√ß√£o.
                    </li>
                </ul>

                <h2>2. Funcionalidades Principais</h2>
                <p>A aplica√ß√£o oferece as seguintes funcionalidades:</p>
                <ul>
                    <li>
                        <strong>Adicionar itens manualmente</strong>: Permite inserir
                        novos produtos no estoque.
                    </li>
                    <li>
                        <strong>Editar itens</strong>: Permite modificar os dados de um
                        produto existente.
                    </li>
                    <li>
                        <strong>Remover itens</strong>: Remove um produto do estoque.
                    </li>
                    <li>
                        <strong>Importar dados de uma planilha</strong>: Carrega dados de
                        um arquivo Excel (<code>.xlsx</code> ou <code>.xls</code>).
                    </li>
                    <li>
                        <strong>Salvar dados manualmente</strong>: Exporta os dados do
                        estoque para um arquivo Excel.
                    </li>
                    <li>
                        <strong>Salvar na mesma base de dados</strong>: Atualiza o arquivo
                        Excel importado com os dados atuais.
                    </li>
                    <li>
                        <strong>Limpar dados</strong>: Remove todos os itens do estoque.
                    </li>
                </ul>

                <h2>3. Passo a Passo para Utiliza√ß√£o</h2>
                <h3>3.1. Adicionar Itens Manualmente</h3>
                <ol>
                    <li>Clique no bot√£o <strong>"Adicionar Manualmente"</strong>.</li>
                    <li>
                        Preencha os campos do formul√°rio:
                        <ul>
                            <li><strong>C√≥digo</strong>: C√≥digo do produto.</li>
                            <li><strong>Produto</strong>: Nome do produto.</li>
                            <li><strong>Quantidade</strong>: Quantidade em estoque.</li>
                            <li>
                                <strong>Data de Validade</strong>: Data de validade do
                                produto.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Clique em <strong>"Adicionar"</strong> para salvar o item ou
                        <strong>"Cancelar"</strong> para fechar o formul√°rio sem salvar.
                    </li>
                </ol>

                <h3>3.2. Editar Itens</h3>
                <ol>
                    <li>Na tabela de estoque, localize o item que deseja editar.</li>
                    <li>Clique no bot√£o <strong>"Editar"</strong> ao lado do item.</li>
                    <li>
                        No modal que abrir, modifique os campos desejados:
                        <ul>
                            <li>
                                <strong>C√≥digo</strong>, <strong>Produto</strong>,
                                <strong>Quantidade</strong>,
                                <strong>Data de Validade</strong>.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Clique em <strong>"Salvar"</strong> para confirmar as altera√ß√µes
                        ou <strong>"Cancelar"</strong> para descart√°-las.
                    </li>
                </ol>

                <h3>3.3. Remover Itens</h3>
                <ol>
                    <li>Na tabela de estoque, localize o item que deseja remover.</li>
                    <li>Clique no bot√£o <strong>"Remover"</strong> ao lado do item.</li>
                    <li>Confirme a remo√ß√£o no alerta que aparecer.</li>
                </ol>

                <h3>3.4. Importar Dados de uma Planilha</h3>
                <ol>
                    <li>
                        Clique no bot√£o <strong>"Escolher Arquivo"</strong> e selecione um
                        arquivo Excel (<code>.xlsx</code> ou <code>.xls</code>).
                    </li>
                    <li>Clique no bot√£o <strong>"Importar Planilha"</strong>.</li>
                    <li>Os dados da planilha ser√£o carregados na tabela de estoque.</li>
                </ol>

                <h3>3.5. Salvar Dados Manualmente</h3>
                <ol>
                    <li>Clique no bot√£o <strong>"Salvar Dados Manuais"</strong>.</li>
                    <li>
                        Um arquivo Excel chamado <strong>estoque_manual.xlsx</strong> ser√°
                        baixado com os dados atuais do estoque.
                    </li>
                </ol>

                <h3>3.6. Salvar na Mesma Base de Dados</h3>
                <ol>
                    <li>Importe uma planilha (se ainda n√£o o fez).</li>
                    <li>Clique no bot√£o <strong>"Salvar Base de Dados"</strong>.</li>
                    <li>
                        O arquivo Excel original ser√° atualizado com os dados atuais do
                        estoque e ser√° baixado automaticamente.
                    </li>
                </ol>

                <h3>3.7. Limpar Dados</h3>
                <ol>
                    <li>Clique no bot√£o <strong>"Limpar Dados"</strong>.</li>
                    <li>Confirme a a√ß√£o no alerta que aparecer.</li>
                    <li>Todos os itens do estoque ser√£o removidos.</li>
                </ol>

                <h2>4. Estrutura da Tabela de Estoque</h2>
                <p>A tabela exibe as seguintes colunas:</p>
                <ul>
                    <li><strong>C√≥digo</strong>: C√≥digo do produto.</li>
                    <li><strong>Produto</strong>: Nome do produto.</li>
                    <li><strong>Quantidade</strong>: Quantidade em estoque.</li>
                    <li>
                        <strong>Data de Validade</strong>: Data de validade do produto.
                    </li>
                    <li>
                        <strong>Dias para Vencer</strong>: Quantidade de dias restantes
                        at√© a data de validade.
                    </li>
                    <li>
                        <strong>Situa√ß√£o</strong>: Estado do produto com base na data de
                        validade (ex: "Dentro da validade", "Vencido").
                    </li>
                    <li><strong>Editar</strong>: Bot√£o para editar o item.</li>
                    <li><strong>Remover</strong>: Bot√£o para remover o item.</li>
                </ul>

                <h2>5. C√≥digos de Situa√ß√£o e Cores</h2>
                <p>
                    A situa√ß√£o do produto √© determinada com base nos dias restantes para
                    a data de validade:
                </p>
                <ul>
                    <li><strong>Vencido</strong>: Produto j√° venceu (cor laranja).</li>
                    <li>
                        <strong>Vence hoje</strong>: Produto vence no dia atual (cor
                        vermelha).
                    </li>
                    <li>
                        <strong>Prazo estourado</strong>: Produto vence em at√© 10 dias
                        (cor rosa).
                    </li>
                    <li>
                        <strong>Dentro da validade</strong>: Produto est√° dentro do prazo
                        (cor verde).
                    </li>
                </ul>

                <h2>6. Como Funciona o C√≥digo</h2>
                <h3>6.1. Armazenamento de Dados</h3>
                <p>
                    Os dados do estoque s√£o armazenados no
                    <strong>localStorage</strong> do navegador, permitindo que as
                    informa√ß√µes persistam mesmo ap√≥s o recarregamento da p√°gina.
                </p>

                <h3>6.2. Atualiza√ß√£o da Tabela</h3>
                <p>
                    A fun√ß√£o <strong>atualizarTabela()</strong> √© respons√°vel por
                    preencher a tabela com os dados do estoque e aplicar as cores de
                    situa√ß√£o.
                </p>

                <h3>6.3. C√°lculo de Dias para Vencer</h3>
                <p>
                    A fun√ß√£o <strong>calcularDiasParaVencer()</strong> calcula a
                    diferen√ßa entre a data de validade e a data atual.
                </p>

                <h3>6.4. Importa√ß√£o e Exporta√ß√£o de Dados</h3>
                <p>
                    A biblioteca <strong>XLSX</strong> √© utilizada para ler e escrever
                    arquivos Excel.
                </p>

                <h2>7. Requisitos para Execu√ß√£o</h2>
                <ul>
                    <li>Navegador moderno (Chrome, Firefox, Edge, etc.).</li>
                    <li>
                        Conex√£o com a internet (para carregar a biblioteca
                        <strong>XLSX</strong>).
                    </li>
                </ul>

                <h2>8. Exemplo de Uso</h2>
                <ol>
                    <li>Abra o arquivo <strong>index.html</strong> no navegador.</li>
                    <li>Adicione alguns itens manualmente ou importe uma planilha.</li>
                    <li>Edite ou remova itens conforme necess√°rio.</li>
                    <li>
                        Exporte os dados para um arquivo Excel ou atualize a planilha
                        original.
                    </li>
                </ol>

                <h2>9. Dicas</h2>
                <ul>
                    <li>
                        Certifique-se de que as datas de validade estejam no formato
                        <strong>AAAA-MM-DD</strong> ao importar uma planilha.
                    </li>
                    <li>
                        Utilize o bot√£o <strong>"Limpar Dados"</strong> com cuidado, pois
                        a a√ß√£o n√£o pode ser desfeita.
                    </li>
                </ul>

                <h2>10. Conclus√£o</h2>
                <p>
                    O <strong>Gestor de Validade em Estoque</strong> √© uma ferramenta
                    simples e eficaz para gerenciar produtos com base em suas datas de
                    validade. Com funcionalidades de adi√ß√£o, edi√ß√£o, remo√ß√£o e
                    importa√ß√£o/exporta√ß√£o de dados, ele √© ideal para pequenos neg√≥cios
                    ou uso pessoal.
                </p>
                <p>
                    Se tiver d√∫vidas ou problemas, consulte o c√≥digo-fonte ou entre em
                    contato com o desenvolvedor. üòä
                </p>
            </div>
        </details>
        <h1>Gestor de Validade em Estoque</h1>
        <div class="botoes">
            <input type="file" id="fileInput" accept=".xlsx, .xls" />
            <button onclick="importarDados()">Importar Planilha</button>
            <button onclick="mostrarFormulario()">Adicionar Manualmente</button>
            <button onclick="salvarBaseDados()">Salvar Base de Dados</button>
            <button onclick="salvarDadosManuais()">Salvar Dados Manuais</button>
            <button onclick="atualizarDatas()">Atualizar Datas</button> <!-- Novo bot√£o -->
            <button onclick="limparDados()" class="btn-limpar">Limpar Dados</button>
        </div>

        <!-- Formul√°rio para adicionar dados manualmente (inicialmente oculto) -->
        <div id="formularioAdicionar" style="display: none">
            <h2>Adicionar Item Manualmente</h2>
            <form id="formAdicionar">
                <label for="codigo">C√≥digo:</label>
                <input type="text" id="codigo" required /><br />

                <label for="produto">Produto:</label>
                <input type="text" id="produto" required /><br />

                <label for="quantidade">Quantidade:</label>
                <input type="number" id="quantidade" required /><br />

                <label for="dataValidade">Data de Validade:</label>
                <input type="date" id="dataValidade" required /><br />

                <button type="submit">Adicionar</button>
                <button type="button" onclick="ocultarFormulario()">Cancelar</button>
            </form>
        </div>

        <!-- Modal de Edi√ß√£o (inicialmente oculto) -->
        <div id="modalEditar" style="display: none">
            <h2>Editar Item</h2>
            <form id="formEditar">
                <label for="editarCodigo">C√≥digo:</label>
                <input type="text" id="editarCodigo" required /><br />

                <label for="editarProduto">Produto:</label>
                <input type="text" id="editarProduto" required /><br />

                <label for="editarQuantidade">Quantidade:</label>
                <input type="number" id="editarQuantidade" required /><br />

                <label for="editarDataValidade">Data de Validade:</label>
                <input type="date" id="editarDataValidade" required /><br />

                <button type="submit">Salvar</button>
                <button type="button" onclick="ocultarModalEditar()">Cancelar</button>
            </form>
        </div>

        <div class="tabela-container">
            <table id="estoqueTable">
                <thead>
                    <tr>
                        <th>C√≥digo</th>
                        <th>Produto</th>
                        <th>Quantidade</th>
                        <th>Data de Validade</th>
                        <th>Dias para Vencer</th>
                        <th>Situa√ß√£o</th>
                        <th>Editar</th>
                        <th>Remover</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dados ser√£o preenchidos via JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="main.js"></script>
</body>

</html>